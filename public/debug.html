<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëª…ë¦¬í•™ ë©”ë‰´ ë””ë²„ê¹…</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; }
        .log { background: #f5f5f5; padding: 10px; margin: 10px 0; font-family: monospace; }
        button { padding: 10px 20px; margin: 5px; }
    </style>
</head>
<body>
    <h1>ğŸ”® ëª…ë¦¬í•™ ë©”ë‰´ ë””ë²„ê¹…</h1>
    
    <div class="test-section">
        <h2>1. ì„œë²„ ìƒíƒœ í™•ì¸</h2>
        <button onclick="checkServers()">ì„œë²„ ìƒíƒœ í™•ì¸</button>
        <div id="serverStatus" class="log"></div>
    </div>
    
    <div class="test-section">
        <h2>2. ëª…ë¦¬í•™ API í…ŒìŠ¤íŠ¸</h2>
        <button onclick="testBaziAPI()">ëª…ë¦¬í•™ API í…ŒìŠ¤íŠ¸</button>
        <div id="baziTest" class="log"></div>
    </div>
    
    <div class="test-section">
        <h2>3. ê´€ë¦¬ì API í…ŒìŠ¤íŠ¸</h2>
        <button onclick="testAdminAPI()">ê´€ë¦¬ì API í…ŒìŠ¤íŠ¸</button>
        <div id="adminTest" class="log"></div>
    </div>
    
    <div class="test-section">
        <h2>4. ì½˜ì†” ë¡œê·¸</h2>
        <div id="consoleLog" class="log"></div>
    </div>

    <script>
        // ì½˜ì†” ë¡œê·¸ ìº¡ì²˜
        const originalLog = console.log;
        const originalError = console.error;
        const logContainer = document.getElementById('consoleLog');
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            logContainer.innerHTML += '<div style="color: blue;">' + args.join(' ') + '</div>';
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            logContainer.innerHTML += '<div style="color: red;">' + args.join(' ') + '</div>';
        };

        async function checkServers() {
            const statusDiv = document.getElementById('serverStatus');
            statusDiv.innerHTML = 'ì„œë²„ ìƒíƒœ í™•ì¸ ì¤‘...';
            
            try {
                // ë©”ì¸ ì„œë²„ í™•ì¸
                const mainResponse = await fetch('http://localhost:3000');
                const mainStatus = mainResponse.ok ? 'âœ… ì •ìƒ' : 'âŒ ì˜¤ë¥˜';
                
                // Bazi API ì„œë²„ í™•ì¸
                const baziResponse = await fetch('http://localhost:3000/health');
                const baziData = await baziResponse.json();
                const baziStatus = baziResponse.ok ? 'âœ… ì •ìƒ' : 'âŒ ì˜¤ë¥˜';
                
                statusDiv.innerHTML = `
                    <div>ë©”ì¸ ì„œë²„ (í¬íŠ¸ 3000): ${mainStatus}</div>
                    <div>Bazi API ì„œë²„ (í¬íŠ¸ 3000): ${baziStatus}</div>
                    <div>Bazi API ìƒíƒœ: ${baziData.status}</div>
                `;
            } catch (error) {
                statusDiv.innerHTML = 'âŒ ì„œë²„ í™•ì¸ ì‹¤íŒ¨: ' + error.message;
            }
        }

        async function testBaziAPI() {
            const testDiv = document.getElementById('baziTest');
            testDiv.innerHTML = 'ëª…ë¦¬í•™ API í…ŒìŠ¤íŠ¸ ì¤‘...';
            
            try {
                const response = await fetch('http://localhost:3000/api/bazi', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        fullName: 'í…ŒìŠ¤íŠ¸',
                        sexAtBirth: 'male',
                        birth: {
                            date: '1990-01-01',
                            time: '12:00',
                            place: 'ì„œìš¸'
                        },
                        locale: 'ko'
                    })
                });
                
                const result = await response.json();
                testDiv.innerHTML = `
                    <div>ì‘ë‹µ ìƒíƒœ: ${response.status}</div>
                    <div>ì‘ë‹µ ë°ì´í„°: ${JSON.stringify(result, null, 2)}</div>
                `;
            } catch (error) {
                testDiv.innerHTML = 'âŒ API í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ' + error.message;
            }
        }

        async function testAdminAPI() {
            const testDiv = document.getElementById('adminTest');
            testDiv.innerHTML = 'ê´€ë¦¬ì API í…ŒìŠ¤íŠ¸ ì¤‘...';
            
            try {
                const response = await fetch('http://localhost:3000/api/admin/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        password: 'admin123'
                    })
                });
                
                const result = await response.json();
                testDiv.innerHTML = `
                    <div>ì‘ë‹µ ìƒíƒœ: ${response.status}</div>
                    <div>ì‘ë‹µ ë°ì´í„°: ${JSON.stringify(result, null, 2)}</div>
                `;
            } catch (error) {
                testDiv.innerHTML = 'âŒ ê´€ë¦¬ì API í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ' + error.message;
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì„œë²„ ìƒíƒœ í™•ì¸
        window.onload = function() {
            console.log('ğŸ” ë””ë²„ê¹… í˜ì´ì§€ ë¡œë“œë¨');
            checkServers();
        };
    </script>
</body>
</html>
